/*!
 * Professional Affiliate Tracking System - Main Stylesheet
 * Version: 2.0.0
 * Author: TeamLead Optimized
 * Description: Complete CSS architecture with theme support, accessibility, and performance optimizations
 * Last Updated: 2025-09-01
 * 
 * Table of Contents:
 * 1. CSS Custom Properties (CSS Variables)
 * 2. Base Styles & Typography
 * 3. Theme System (Light/Dark Mode)
 * 4. Layout Components
 * 5. Form Controls & Inputs
 * 6. Tables & DataTables
 * 7. Buttons & Interactive Elements
 * 8. Modals & Overlays
 * 9. Navigation & Sidebar 
 * 10. Utility Classes
 * 11. Responsive Design
 * 12. Animation & Transitions
 * 13. Accessibility Enhancements
 */

/* ================= 1. CSS CUSTOM PROPERTIES ================= */
/* Primary color system with semantic naming */
:root {
    /* === Brand Colors === */
    --primary-color: #0066cc;
    --primary-hover: #0052a3;
    --primary-light: #e3f2fd;
    --primary-dark: #003d7a;
    
    /* === Semantic Colors === */
    --success-color: #28a745;
    --success-light: #d4edda;
    --danger-color: #dc3545;
    --danger-light: #f8d7da;
    --warning-color: #f39c12;
    --warning-light: #fff3cd;
    --info-color: #17a2b8;
    --info-light: #d1ecf1;
    --secondary-color: #6c757d;
    --secondary-light: #e2e3e5;
    
    /* === Light Theme Variables (Default) === */
    /* Background colors with improved contrast ratios */
    --bg-main: #f8f9fa;           /* WCAG AAA compliant base */
    --bg-card: #ffffff;           /* Pure white for cards */
    --bg-sidebar: #2c3e50;        /* Professional dark sidebar */
    --bg-navbar: #ffffff;         /* Clean white navbar */
    --bg-table: #ffffff;          /* Table background */
    --bg-table-stripe: #f8f9fa;   /* Subtle striping */
    --bg-table-hover: #e3f2fd;    /* Clear hover indication */
    
    /* Text colors with WCAG AA+ compliance */
    --text-primary: #2c3e50;      /* High contrast primary text */
    --text-secondary: #5a6c7d;    /* Medium contrast secondary */
    --text-muted: #7b8a9a;        /* Lower contrast for hints */
    --text-contrast: #ffffff;     /* White text on dark backgrounds */
    --text-link: #0066cc;         /* Accessible link color */
    --text-link-hover: #0052a3;   /* Darker hover state */
    
    /* Border and spacing system */
    --border-color: #e1e8ed;      /* Subtle borders */
    --border-light: rgba(44, 62, 80, 0.1);  /* Ultra-light borders */
    --border-radius: 0.375rem;    /* Consistent radius */
    --border-radius-lg: 0.5rem;   /* Large elements */
    --border-radius-sm: 0.25rem;  /* Small elements */
    
    /* Shadow system for depth */
    --shadow-sm: 0 0.125rem 0.25rem rgba(44, 62, 80, 0.075);
    --shadow: 0 0.125rem 0.25rem rgba(44, 62, 80, 0.1);
    --shadow-lg: 0 0.5rem 1rem rgba(44, 62, 80, 0.15);
    --shadow-hover: 0 0.25rem 0.5rem rgba(44, 62, 80, 0.2);
    
    /* Form controls */
    --input-bg: #ffffff;
    --input-border: #d1d9e0;
    --input-focus-border: #0066cc;
    --input-focus-shadow: 0 0 0 0.2rem rgba(0, 102, 204, 0.25);
    
    /* Dropdown system */
    --dropdown-bg: #ffffff;
    --dropdown-border: #e1e8ed;
    --dropdown-shadow: 0 0.5rem 1rem rgba(44, 62, 80, 0.175);
    
    /* Animation and timing */
    --transition-fast: 0.15s ease;
    --transition-base: 0.3s ease;
    --transition-slow: 0.5s ease;
    --animation-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    /* Spacing scale */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 3rem;
    
    /* Mobile spacing - minimized for more screen real estate */
    --mobile-space-xs: 0.125rem;
    --mobile-space-sm: 0.25rem;
    --mobile-space-md: 0.5rem;
    --mobile-space-lg: 0.75rem;
    --mobile-space-xl: 1rem;
}

/* === Dark Theme Variables (GitHub-inspired) === */
.dark-mode {
    /* Dark theme with improved readability and modern aesthetics */
    --bg-main: #0d1117;          /* GitHub dark background */
    --bg-card: #161b22;          /* Card background with slight elevation */
    --bg-sidebar: #0d1117;       /* Consistent sidebar */
    --bg-navbar: #161b22;        /* Elevated navbar */
    --bg-table: #161b22;         /* Table background */
    --bg-table-stripe: #21262d;  /* Subtle row striping */
    --bg-table-hover: #1c2128;   /* Clear hover indication */
    
    /* High contrast text for accessibility */
    --text-primary: #f0f6fc;     /* Primary text - WCAG AAA */
    --text-secondary: #7d8590;   /* Secondary text - WCAG AA */
    --text-muted: #656d76;       /* Muted text for hints */
    --text-contrast: #0d1117;    /* Dark text on light backgrounds */
    --text-link: #58a6ff;        /* Accessible blue links */
    --text-link-hover: #79c0ff;  /* Lighter hover state */
    
    /* Border system for dark theme */
    --border-color: #30363d;     /* Visible but subtle borders */
    --border-light: rgba(240, 246, 252, 0.1);  /* Very light borders */
    
    /* Enhanced shadows for dark theme */
    --shadow-sm: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.3);
    --shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.5);
    --shadow-lg: 0 0.5rem 1rem rgba(0, 0, 0, 0.7);
    --shadow-hover: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.8);
    
    /* Form controls for dark theme */
    --input-bg: #0d1117;
    --input-border: #30363d;
    --input-focus-border: #58a6ff;
    --input-focus-shadow: 0 0 0 0.2rem rgba(88, 166, 255, 0.25);
    
    /* Dropdown system for dark theme */
    --dropdown-bg: #161b22;
    --dropdown-border: #30363d;
    --dropdown-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.8);
}

/* ================= 2. BASE STYLES & TYPOGRAPHY ================= */
/* Modern typography system with improved readability */
body {
    background-color: var(--bg-main) !important;
    color: var(--text-primary) !important;
    transition: all var(--transition-base);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    font-size: 1rem;
    line-height: 1.6;
    font-weight: 400;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Smooth theme transitions */
body.theme-changing {
    transition: all var(--transition-slow) cubic-bezier(0.4, 0, 0.2, 1);
}

/* Typography scale with improved hierarchy */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary) !important;
    font-weight: 600;
    letter-spacing: -0.025em;
    margin-bottom: var(--space-md);
    line-height: 1.25;
}

h1 { 
    font-size: 2.25rem; 
    font-weight: 700;
    line-height: 1.2; 
}
h2 { 
    font-size: 1.875rem; 
    line-height: 1.3; 
}
h2 { 
    font-size: 1.5rem; 
    line-height: 1.4; 
}
h4 { 
    font-size: 1.25rem; 
    line-height: 1.5; 
}
h5 { 
    font-size: 1.125rem; 
    line-height: 1.5; 
}
h6 { 
    font-size: 1rem; 
    font-weight: 600;
    line-height: 1.6; 
}

/* Enhanced label styling */
label {
    color: var(--text-primary) !important;
    font-weight: 500;
    margin-bottom: var(--space-sm);
    display: block;
}

.form-label {
    color: var(--text-primary) !important;
    font-weight: 600;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-md);
}

/* Text utilities with improved contrast */
small {
    color: var(--text-secondary) !important;
    font-size: 0.875rem;
    line-height: 1.4;
}

/* Code styling */
code {
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-link) !important;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-sm);
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* Link improvements with accessibility focus */
a {
    color: var(--text-link) !important;
    text-decoration: none;
    transition: all var(--transition-fast);
    font-weight: 500;
}

a:hover {
    color: var(--text-link-hover) !important;
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
}

a:focus {
    outline: 2px solid var(--text-link);
    outline-offset: 2px;
    border-radius: var(--border-radius-sm);
}

/* ================= 3. THEME SYSTEM & TOGGLE ================= */
/* Enhanced theme toggle with smooth animations */
#theme-toggle {
    transition: all var(--transition-base);
    padding: var(--space-md);
    border-radius: 50%;
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

#theme-toggle::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(circle, transparent 60%, var(--bg-table-hover) 100%);
    opacity: 0;
    transition: opacity var(--transition-base);
}

#theme-toggle:hover::before {
    opacity: 1;
}

#theme-toggle:hover {
    background-color: var(--table-hover);
    transform: scale(1.1);
}

#theme-toggle i {
    transition: all var(--transition-slow) var(--animation-bounce);
    font-size: 1.25rem;
    z-index: 1;
}

#theme-toggle:hover i {
    transform: rotate(180deg);
}

#theme-toggle.theme-changed {
    transform: scale(1.3);
    background-color: var(--primary-color);
    color: white;
}

#theme-toggle.theme-changed i {
    transform: rotate(360deg);
}

/* Performance optimization for theme switching */
@media (prefers-reduced-motion: reduce) {
    #theme-toggle,
    #theme-toggle i,
    body.theme-changing {
        transition: none !important;
    }
}

.content-wrapper {
    background-color: var(--bg-main) !important;
}

/* Navbar темная тема */
.dark-mode .main-header.navbar {
    background-color: var(--bg-navbar) !important;
    border-bottom: 1px solid var(--border-color);
}

.dark-mode .navbar-nav .nav-link {
    color: var(--text-primary) !important;
    font-size: 2rem;
    line-height: 0;
}

.dark-mode .navbar-nav .nav-link:hover {
    color: var(--text-link) !important;
}

/* Sidebar customization */
.brand-link .brand-image {
    opacity: .8;
}
.small-box .icon {
    font-size: 70px;
}

/* Карточки */
.card {
    background-color: var(--bg-card) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: var(--shadow);
    transition: all 0.3s ease;
    color: var(--text-primary) !important;
}

.card-header {
    background-color: var(--bg-card) !important;
    border-bottom: 1px solid var(--border-color) !important;
    color: var(--text-primary) !important;
}

.card-body {
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

.card-primary.card-outline {
    border-color: var(--primary-color) !important;
}

.card-primary.card-outline .card-header {
    border-bottom-color: var(--border-color) !important;
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

/* Таблицы */
.table {
    color: var(--text-primary) !important;
    border-color: var(--border-color) !important;
    background-color: var(--bg-table) !important;
}

.table th,
.table td {
    border-color: var(--border-color) !important;
    color: var(--text-primary) !important;
    background-color: var(--bg-table) !important;
}

.table thead th {
    border-bottom: 2px solid var(--border-color) !important;
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-primary) !important;
    font-weight: 600;
}

.table-striped > tbody > tr:nth-of-type(odd) > td {
    background-color: var(--bg-table-stripe) !important;
}

.table-hover > tbody > tr:hover {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

.table-hover > tbody > tr:hover > * {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

/* Таблица партнеров */
#partnersTableBody tr {
    background-color: var(--bg-table) !important;
    color: var(--text-primary) !important;
}

#partnersTableBody tr:hover {
    background-color: var(--bg-table-hover) !important;
}

#partnersTableBody tr td {
    background-color: inherit !important;
    color: var(--text-primary) !important;
}

/* Отзывчивые таблицы */
.table-responsive {
    background-color: var(--bg-card) !important;
}

/* Формы и элементы ввода */
.form-control,
.form-select {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
    color: var(--text-primary) !important;
    transition: all 0.3s ease;
}

.form-control:focus,
.form-select:focus {
    border-color: var(--input-focus-border) !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
    background-color: var(--input-bg) !important;
    color: var(--text-primary) !important;
}

.form-control::placeholder {
    color: var(--text-muted) !important;
    opacity: 1;
}

.form-control:disabled,
.form-control[readonly] {
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-secondary) !important;
    border-color: var(--border-color) !important;
}

/* Date picker styling */
.form-control[type="date"] {
    color-scheme: light;
}

.dark-mode .form-control[type="date"] {
    color-scheme: dark;
}

.form-control[type="date"]::-webkit-calendar-picker-indicator {
    filter: none;
    opacity: 0.7;
    transition: opacity 0.3s ease;
}

.dark-mode .form-control[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(1);
}

.form-control[type="date"]:hover::-webkit-calendar-picker-indicator {
    opacity: 1;
}

/* Модальные окна */
.modal-content {
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
}

.modal-header {
    border-bottom-color: var(--border-color) !important;
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

.modal-body {
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

.modal-footer {
    border-top-color: var(--border-color) !important;
    background-color: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

/* Dropdown menus */
.dropdown-menu {
    background-color: var(--dropdown-bg) !important;
    border: 1px solid var(--dropdown-border) !important;
    box-shadow: var(--dropdown-shadow) !important;
    z-index: 1050 !important;
}

.dropdown-item {
    color: var(--text-primary) !important;
    background-color: transparent !important;
}

.dropdown-item:hover,
.dropdown-item:focus {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

.dropdown-divider {
    border-top: 1px solid var(--border-color) !important;
}

/* Columns dropdown fix */
.columns-dropdown {
    background-color: var(--dropdown-bg) !important;
    border: 1px solid var(--dropdown-border) !important;
    box-shadow: var(--dropdown-shadow) !important;
    z-index: 9999 !important;
    position: absolute !important;
    min-width: 200px;
    max-height: 300px;
    overflow-y: auto;
}

.columns-dropdown .form-check {
    margin: 0;
}

.columns-dropdown .form-check:hover {
    background-color: var(--bg-table-hover) !important;
}

.columns-dropdown .form-check-label {
    color: var(--text-primary) !important;
    width: 100%;
    cursor: pointer;
}

.columns-dropdown .form-check-input {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
}

.columns-dropdown .form-check-input:checked {
    background-color: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
}

/* Навигационные вкладки */
.nav-tabs .nav-link {
    color: var(--text-secondary);
    border-bottom-color: var(--border-color);
}

.nav-tabs .nav-link.active {
    background-color: var(--bg-card);
    border-color: var(--border-color) var(--border-color) var(--bg-card);
    color: var(--text-primary);
}

.card-tabs .nav-tabs .nav-link {
    color: var(--text-secondary);
}

.card-tabs .nav-tabs .nav-link.active {
    background-color: var(--bg-card);
    color: var(--text-primary);
}

/* Кнопки */
.btn {
    transition: all 0.3s ease;
    border-radius: 0.375rem;
}

.btn-primary {
    background-color: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
    color: var(--text-contrast) !important;
}

.btn-primary:hover,
.btn-primary:focus {
    background-color: var(--primary-hover) !important;
    border-color: var(--primary-hover) !important;
    color: var(--text-contrast) !important;
}

.btn-outline-secondary {
    color: var(--text-secondary) !important;
    border-color: var(--border-color) !important;
    background-color: transparent !important;
}

.btn-outline-secondary:hover,
.btn-outline-secondary:focus {
    background-color: var(--text-secondary) !important;
    border-color: var(--text-secondary) !important;
    color: var(--text-contrast) !important;
}

.btn-success {
    background-color: var(--success-color) !important;
    border-color: var(--success-color) !important;
    color: var(--text-contrast) !important;
}

.btn-danger {
    background-color: var(--danger-color) !important;
    border-color: var(--danger-color) !important;
    color: var(--text-contrast) !important;
}

.btn-warning {
    background-color: var(--warning-color) !important;
    border-color: var(--warning-color) !important;
    color: var(--text-contrast) !important;
}

.btn-secondary {
    background-color: var(--secondary-color) !important;
    border-color: var(--secondary-color) !important;
    color: var(--text-contrast) !important;
}

/* Badges */
.badge {
    transition: all 0.3s ease;
    font-weight: 600;
}

.badge:hover {
    transform: scale(1.05);
}

.badge.bg-success {
    background-color: var(--success-color) !important;
    color: var(--text-contrast) !important;
}

.badge.bg-danger {
    background-color: var(--danger-color) !important;
    color: var(--text-contrast) !important;
}

.badge.bg-warning {
    background-color: var(--warning-color) !important;
    color: var(--text-contrast) !important;
}

.badge.bg-secondary {
    background-color: var(--secondary-color) !important;
    color: var(--text-contrast) !important;
}

.badge.bg-primary {
    background-color: var(--primary-color) !important;
    color: var(--text-contrast) !important;
}

.badge.bg-info {
    background-color: var(--info-color) !important;
    color: var(--text-contrast) !important;
}

/* Текстовые утилиты с улучшенными контрастами */
.text-muted {
    color: var(--text-muted) !important;
}

.text-secondary {
    color: var(--text-secondary) !important;
}

.text-primary {
    color: var(--text-primary) !important;
    font-weight: 500;
}

/* Text contrast utilities */
.text-contrast {
    color: var(--text-contrast) !important;
}

/* Ensure readable text on different backgrounds */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary) !important;
    font-weight: 600;
    letter-spacing: -0.025em;
}

h1 { font-size: 2.25rem; line-height: 1.2; }
h2 { font-size: 1.875rem; line-height: 1.3; }
h3 { font-size: 1.5rem; line-height: 1.4; }
h4 { font-size: 1.25rem; line-height: 1.5; }
h5 { font-size: 1.125rem; line-height: 1.5; }
h6 { font-size: 1rem; line-height: 1.6; }

label {
    color: var(--text-primary) !important;
    font-weight: 500;
    margin-bottom: 0.5rem;
}

.form-label {
    color: var(--text-primary) !important;
    font-weight: 600;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.75rem;
}

small {
    color: var(--text-secondary) !important;
    font-size: 0.875rem;
    line-height: 1.4;
}

code {
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-link) !important;
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
}

/* Links with improved accessibility */
a {
    color: var(--text-link) !important;
    text-decoration: none;
    transition: all 0.2s ease;
    font-weight: 500;
}

a:hover {
    color: var(--text-link-hover) !important;
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
}

a:focus {
    outline: 2px solid var(--text-link);
    outline-offset: 2px;
    border-radius: 0.25rem;
}

/* Enhanced text utilities */
.text-semibold {
    font-weight: 600 !important;
}

.text-medium {
    font-weight: 500 !important;
}

.text-gradient {
    background: linear-gradient(135deg, var(--primary-color), var(--info-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 700;
}

/* Text truncation with improved UX */
.text-truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
    display: inline-block;
    vertical-align: middle;
    cursor: help;
    transition: all 0.2s ease;
}

.text-truncate:hover {
    background-color: var(--bg-table-hover);
    border-radius: 0.25rem;
    padding: 0.125rem 0.25rem;
}

.url-truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 250px;
    display: inline-block;
    vertical-align: middle;
    cursor: help;
    transition: all 0.2s ease;
}

.url-truncate:hover {
    background-color: var(--bg-table-hover);
    border-radius: 0.25rem;
    padding: 0.125rem 0.25rem;
}

/* Improved readability helpers */
.reading-width {
    max-width: 65ch;
}

.text-balance {
    text-wrap: balance;
}

.text-pretty {
    text-wrap: pretty;
}

/* Tag input styles */
.tags-input-wrapper { 
    background: var(--input-bg); 
    border: 1px solid var(--input-border); 
    border-radius: .25rem; 
    padding: .375rem .75rem; 
    display: flex; 
    flex-wrap: wrap; 
    align-items: center; 
    cursor: text; 
    transition: all 0.3s ease;
}

.tags-input-wrapper:focus-within {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.tags-input-container { 
    display: flex; 
    flex-wrap: wrap; 
    gap: 5px; 
    width: 100%; 
    align-items: center; 
}

.tags-typing-input { 
    background: transparent; 
    border: none; 
    padding: 0; 
    margin: 0; 
    outline: none; 
    box-shadow: none; 
    flex-grow: 1; 
    min-width: 150px; 
    font-family: inherit; 
    font-size: 1rem; 
    line-height: 1.5; 
    color: var(--text-primary); 
    transition: color 0.3s ease;
}

.tags-typing-input::placeholder {
    color: var(--text-muted);
}

.tag { 
    background-color: var(--primary-color); 
    color: white; 
    padding: 3px 8px; 
    border-radius: 5px; 
    display: inline-flex; 
    align-items: center; 
    font-size: 0.9em; 
    white-space: nowrap;
    transition: all 0.3s ease;
}

.tag:hover {
    background-color: var(--primary-hover);
    transform: scale(1.05);
}

.tag-remove { 
    cursor: pointer; 
    margin-left: 5px; 
    font-weight: bold;
    transition: opacity 0.3s ease;
}

.tag-remove:hover {
    opacity: 0.7;
}

/* Алерты и уведомления */
.alert {
    border: 1px solid var(--border-color);
}

.alert-success {
    background-color: rgba(40, 167, 69, 0.1);
    border-color: var(--success-color);
    color: var(--success-color);
}

.alert-danger {
    background-color: rgba(220, 53, 69, 0.1);
    border-color: var(--danger-color);
    color: var(--danger-color);
}

.alert-warning {
    background-color: rgba(255, 193, 7, 0.1);
    border-color: var(--warning-color);
    color: #856404;
}

.dark-mode .alert-warning {
    color: #ffc107;
}

/* Badges */
.badge {
    transition: all 0.3s ease;
}

.badge:hover {
    transform: scale(1.1);
}

/* Custom Emoji Close Button for Modal */
.modal-close-emoji-btn {
    border: none;
    background: transparent;
    font-size: 1.2rem;
    padding: 0.5rem 1rem;
    margin: -0.5rem -0.5rem -0.5rem auto;
    opacity: 0.7;
    transition: opacity .2s ease-in-out, transform .2s ease-in-out;
    color: var(--text-primary);
}

.modal-close-emoji-btn:hover {
    opacity: 1;
    transform: scale(1.1);
    color: var(--text-primary);
}

/* Навигация */
.main-nav-link.active {
    background-color: var(--primary-color) !important;
    color: #ffffff !important;
}

/* Button with spinner */
#savePartnerBtn i, #globalSettingsForm button i {
    transition: all 0.2s ease-in-out;
}
#savePartnerBtn .spinner-border, #globalSettingsForm button .spinner-border {
    margin-right: .5rem;
}

/* ================= DATATABLES СТИЛИ ================= */

/* Основные стили DataTables */
.dataTables_wrapper {
    color: var(--text-primary) !important;
}

.dataTables_wrapper .card-body {
    background-color: var(--bg-card) !important;
}

.dataTables_wrapper .table {
    color: var(--text-primary) !important;
    background-color: var(--bg-table) !important;
}

/* DataTables элементы управления */
.dataTables_wrapper .dt-length select,
.dataTables_wrapper .dt-search input {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
    color: var(--text-primary) !important;
}

.dataTables_length label,
.dataTables_filter label {
    color: var(--text-primary) !important;
}

.dataTables_length select {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
    color: var(--text-primary) !important;
}

.dataTables_filter input {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
    color: var(--text-primary) !important;
}

/* Пагинация */
.dataTables_wrapper .dataTables_paginate .page-link {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
    color: var(--text-primary) !important;
    transition: all 0.3s ease;
}

.dataTables_wrapper .dataTables_paginate .page-link:hover {
    background-color: var(--bg-table-hover) !important;
    border-color: var(--border-color) !important;
    color: var(--text-primary) !important;
}

.dataTables_wrapper .dataTables_paginate .page-item.active .page-link {
    background-color: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
    color: var(--text-contrast) !important;
}

.dataTables_wrapper .dataTables_paginate .page-item.disabled .page-link {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
    color: var(--text-muted) !important;
}

/* Заголовки и подвалы таблиц */
table.dataTable thead th,
table.dataTable thead td {
    border-bottom: 2px solid var(--border-color) !important;
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-primary) !important;
    font-weight: 600;
}

table.dataTable tfoot th,
table.dataTable tfoot td {
    border-top: 1px solid var(--border-color) !important;
    background-color: var(--bg-table-stripe) !important;
    color: var(--text-primary) !important;
    font-weight: 600;
    padding: 0.75rem !important;
}

/* Ensure footer is always visible */
table.dataTable tfoot {
    display: table-footer-group !important;
}

/* Enhanced pagination styling */
.dataTables_wrapper .dataTables_paginate {
    margin-top: 1rem !important;
    display: flex !important;
    justify-content: center !important;
}

.dataTables_wrapper .dataTables_paginate .pagination {
    margin-bottom: 0 !important;
}

/* Enhanced info styling */
.dataTables_wrapper .dataTables_info {
    padding-top: 0.75rem !important;
    color: var(--text-secondary) !important;
    font-size: 0.875rem !important;
}

/* DataTables length selector */
.dataTables_wrapper .dataTables_length {
    margin-bottom: 1rem !important;
}

.dataTables_wrapper .dataTables_length select {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
    color: var(--text-primary) !important;
    padding: 0.375rem 0.75rem !important;
    border-radius: 0.375rem !important;
}

table.dataTable tbody th,
table.dataTable tbody td {
    border-color: var(--border-color) !important;
    background-color: var(--bg-table) !important;
    color: var(--text-primary) !important;
}

/* Hover эффекты */
.dataTables_wrapper .table-hover > tbody > tr:hover > * {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

table.dataTable tbody tr:hover {
    background-color: var(--bg-table-hover) !important;
}

table.dataTable tbody tr:hover td {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

/* Информация и обработка */
.dataTables_info {
    color: var(--text-secondary) !important;
}

.dataTables_processing {
    background: var(--bg-card) !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
}

/* Buttons */
.dt-buttons .btn {
    background-color: var(--bg-card) !important;
    border-color: var(--border-color) !important;
    color: var(--text-primary) !important;
}

.dt-buttons .btn:hover {
    background-color: var(--bg-table-hover) !important;
}

/* Элементы управления колонками */
table.dataTable th {
    position: relative;
}

table.dataTable th.reordering,
table.dataTable thead th.dt-colreorder-resizing {
    cursor: col-resize;
    border-right: 2px solid var(--primary-color) !important;
}

/* Responsive элементы */
table.dataTable.dtr-inline.collapsed>tbody>tr>td.dtr-control::before,
table.dataTable.dtr-inline.collapsed>tbody>tr>th.dtr-control::before {
    background-color: var(--primary-color) !important;
}

/* ================= СТАТИСТИЧЕСКИЕ КАРТОЧКИ ================= */

/* Partner List Table on Dashboard */
.card-body.table-responsive {
    background-color: var(--bg-card) !important;
}

#partnersTableBody tr {
    background-color: var(--bg-table) !important;
    color: var(--text-primary) !important;
}

#partnersTableBody tr:hover {
    background-color: var(--bg-table-hover) !important;
}

#partnersTableBody tr td {
    background-color: inherit !important;
    color: var(--text-primary) !important;
}

/* Статистические числа в карточках партнеров */
.partner-stats {
    background-color: var(--bg-table-stripe) !important;
    border-radius: 0.375rem;
    padding: 0.75rem;
    margin-top: 0.75rem;
    transition: all 0.3s ease;
    border: 1px solid var(--border-color);
}

.partner-stats:hover {
    background-color: var(--bg-table-hover) !important;
    transform: translateY(-1px);
    box-shadow: var(--shadow-hover);
}

.partner-stats .stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
    padding: 0.25rem 0;
}

.partner-stats .stat-item:last-child {
    margin-bottom: 0;
}

.partner-stats .stat-label {
    color: var(--text-secondary) !important;
    font-size: 0.875rem;
    font-weight: 500;
}

.partner-stats .stat-values {
    font-weight: 600;
    color: var(--text-primary) !important;
    font-feature-settings: 'tnum';
    font-variant-numeric: tabular-nums;
}

.partner-stats .stat-values .sum-count {
    color: var(--success-color) !important;
    font-weight: 700;
}

.partner-stats .stat-values .map-count {
    color: var(--info-color) !important;
    font-weight: 700;
}

/* Small boxes improvements */
.small-box {
    border-radius: 0.5rem;
    box-shadow: var(--shadow);
    transition: all 0.3s ease;
    overflow: hidden;
}

.small-box:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-hover);
}

.small-box .inner {
    color: white !important;
}

.small-box .icon {
    color: rgba(255, 255, 255, 0.3) !important;
}

/* ================= ДОПОЛНИТЕЛЬНЫЕ УЛУЧШЕНИЯ ================= */

/* Smooth transitions for all interactive elements */
* {
    transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}

/* Улучшенный стиль для кнопки переключения темы */
#theme-toggle {
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    transition: all 0.3s ease;
}

#theme-toggle:hover {
    background-color: var(--table-hover);
    transform: scale(1.1);
}

/* Анимация для иконки переключения темы */
#theme-toggle i {
    transition: transform 0.5s ease, color 0.3s ease;
}

#theme-toggle:hover i {
    transform: rotate(180deg);
}

/* Карточки без анимации наведения (по запросу пользователя) */
.card {
    transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
}

/* Removed card hover effects */

/* Пульсирующий эффект для новых данных */
@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(0, 123, 255, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
    }
}

.pulse-animation {
    animation: pulse 2s infinite;
}

/* Улучшенная типография */
.stat-values {
    font-feature-settings: 'tnum';
    font-variant-numeric: tabular-nums;
}

/* Стиль для активных элементов навигации */
.nav-link.active,
.main-nav-link.active {
    position: relative;
}

.nav-link.active::after,
.main-nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 2px;
    background-color: var(--primary-color);
    border-radius: 1px;
}

/* Улучшенный стиль для скроллбара в темной теме */
.dark-mode ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

.dark-mode ::-webkit-scrollbar-track {
    background: var(--bg-card);
}

.dark-mode ::-webkit-scrollbar-thumb {
    background: var(--text-muted);
    border-radius: 4px;
}

.dark-mode ::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* ================= УЛУЧШЕННЫЕ UI/UX ЭЛЕМЕНТЫ ================= */

/* Enhanced loading states */
.btn.loading {
    pointer-events: none;
    opacity: 0.8;
}

.btn.loading .spinner-border {
    width: 1rem;
    height: 1rem;
    border-width: 0.125em;
    margin-right: 0.5rem;
}

/* Card styling without hover effects and overflow hidden removed */
.card {
    transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
    border-radius: 0.75rem;
    /* overflow: hidden removed per user request */
}

/* Removed card hover animations per user request */

/* Enhanced form focus states */
.form-control:focus,
.form-select:focus {
    border-color: var(--input-focus-border) !important;
    box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1) !important;
    transform: translateY(-1px);
}

/* Improved button styles */
.btn {
    font-weight: 600;
    letter-spacing: 0.025em;
    border-radius: 0.5rem;
    padding: 0.75rem 1.5rem;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.btn:hover::before {
    left: 100%;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

.btn:active {
    transform: translateY(0);
}

/* Enhanced small-box styling */
.small-box {
    border-radius: 1rem;
    overflow: hidden;
    position: relative;
    background: linear-gradient(135deg, var(--primary-color), var(--info-color));
}

.small-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
    pointer-events: none;
}

.small-box:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 1.5rem 3rem rgba(0, 0, 0, 0.2);
}

/* Animated progress bars */
@keyframes shimmer {
    0% { background-position: -200px 0; }
    100% { background-position: calc(200px + 100%) 0; }
}

.progress-bar-animated {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200px 100%;
    animation: shimmer 1.5s infinite;
}

/* Enhanced table styling */
.table {
    border-radius: 0.75rem;
    overflow: hidden;
    box-shadow: var(--shadow);
}

.table thead th {
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.75rem;
    padding: 1rem;
    border: none;
}

.table tbody td {
    padding: 1rem;
    border-top: 1px solid var(--border-color);
    vertical-align: middle;
}

.table tbody tr {
    transition: all 0.2s ease;
}

.table tbody tr:hover {
    transform: translateX(4px);
}

/* Enhanced badges */
.badge {
    font-weight: 600;
    font-size: 0.75rem;
    padding: 0.5rem 0.75rem;
    border-radius: 2rem;
    letter-spacing: 0.025em;
    text-transform: uppercase;
    transition: all 0.2s ease;
}

.badge:hover {
    transform: scale(1.1);
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.15);
}

/* Improved modal styling */
.modal-content {
    border-radius: 1rem;
    border: none;
    box-shadow: 0 2rem 4rem rgba(0, 0, 0, 0.15);
}

.modal-header {
    border-bottom: 1px solid var(--border-color);
    padding: 1.5rem;
    border-radius: 1rem 1rem 0 0;
}

.modal-body {
    padding: 2rem;
}

.modal-footer {
    border-top: 1px solid var(--border-color);
    padding: 1.5rem;
    border-radius: 0 0 1rem 1rem;
}

/* Enhanced scrollbar styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-table-stripe);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: var(--text-muted);
    border-radius: 4px;
    transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Loading overlay */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    backdrop-filter: blur(4px);
}

.loading-overlay.show {
    opacity: 1;
    visibility: visible;
}

.loading-spinner {
    width: 3rem;
    height: 3rem;
    border: 4px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Micro-interactions */
.clickable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.clickable:hover {
    transform: scale(1.05);
}

.clickable:active {
    transform: scale(0.95);
}

/* Focus styles for accessibility */
*:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
    border-radius: 0.25rem;
}

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* ================= 11. COMPREHENSIVE MOBILE RESPONSIVE DESIGN ================= */

/* Mobile-first responsive breakpoints */
/* xs: 0-479px (phones portrait) */
/* sm: 480-767px (phones landscape) */
/* md: 768-991px (tablets) */
/* lg: 992-1199px (small laptops) */
/* xl: 1200px+ (desktops) */

/* === MOBILE BASE STYLES === */
/* Enhanced mobile typography */
@media (max-width: 767px) {
    body {
        font-size: 0.875rem;
        line-height: 1.5;
        padding: 0;
        margin: 0;
    }
    
    h1 { font-size: 1.5rem; margin-bottom: var(--mobile-space-md); }
    h2 { font-size: 1.375rem; margin-bottom: var(--mobile-space-md); }
    h3 { font-size: 1.25rem; margin-bottom: var(--mobile-space-md); }
    h4 { font-size: 1.125rem; margin-bottom: var(--mobile-space-sm); }
    h5 { font-size: 1rem; margin-bottom: var(--mobile-space-sm); }
    h6 { font-size: 0.875rem; margin-bottom: var(--mobile-space-sm); }
    
    /* Minimize all padding and margins on mobile */
    .container-fluid {
        padding-left: var(--mobile-space-sm);
        padding-right: var(--mobile-space-sm);
    }
    
    .row {
        margin-left: calc(-1 * var(--mobile-space-xs));
        margin-right: calc(-1 * var(--mobile-space-xs));
    }
    
    .col, [class*="col-"] {
        padding-left: var(--mobile-space-xs);
        padding-right: var(--mobile-space-xs);
    }
}

/* === DATATABLES RESPONSIVE STYLING === */
/* Mobile-optimized DataTables */
@media (max-width: 767px) {
    .dataTables_wrapper {
        font-size: 0.875rem;
        padding: var(--mobile-space-sm);
    }
    
    .dataTables_wrapper .dataTables_length,
    .dataTables_wrapper .dataTables_filter,
    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_paginate {
        text-align: center;
        margin-bottom: var(--mobile-space-sm);
        padding: var(--mobile-space-xs);
    }
    
    .dataTables_wrapper .dataTables_length select,
    .dataTables_wrapper .dataTables_filter input {
        width: 100% !important;
        max-width: 100%;
        margin: 0 auto;
        padding: var(--mobile-space-sm);
        font-size: 0.875rem;
    }
    
    /* Mobile pagination */
    .dataTables_wrapper .dataTables_paginate .paginate_button {
        padding: var(--mobile-space-xs) var(--mobile-space-sm) !important;
        margin: var(--mobile-space-xs) !important;
        font-size: 0.75rem !important;
        min-width: 28px;
        height: 28px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .dataTables_wrapper .dataTables_paginate .paginate_button.current {
        background: var(--primary-color) !important;
        color: white !important;
        border-color: var(--primary-color) !important;
    }
    
    /* Hide some pagination buttons on very small screens */
    @media (max-width: 479px) {
        .dataTables_wrapper .dataTables_paginate .paginate_button:not(.current):not(.next):not(.previous) {
            display: none;
        }
    }
}

/* DataTables responsive details styling */
.responsive-details {
    background: var(--bg-table-stripe);
    border-radius: var(--border-radius);
    padding: var(--mobile-space-md);
    margin-top: var(--mobile-space-sm);
}

.responsive-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: var(--mobile-space-xs) 0;
    border-bottom: 1px solid var(--border-light);
}

.responsive-item:last-child {
    border-bottom: none;
}

.responsive-title {
    font-weight: 600;
    color: var(--text-secondary);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    flex: 0 0 30%;
    margin-right: var(--mobile-space-sm);
}

.responsive-data {
    flex: 1;
    text-align: right;
    word-break: break-word;
    font-size: 0.875rem;
}

/* === MOBILE FORM CONTROLS === */
@media (max-width: 767px) {
    /* Enhanced form controls for touch */
    .form-control,
    .form-select {
        min-height: 44px; /* Touch-friendly minimum */
        font-size: 1rem; /* Prevent zoom on iOS */
        border-radius: var(--border-radius);
        padding: var(--mobile-space-sm) var(--mobile-space-md);
    }
    
    .form-control:focus,
    .form-select:focus {
        box-shadow: 0 0 0 0.25rem rgba(var(--primary-color-rgb), 0.25);
        border-color: var(--primary-color);
    }
    
    /* Touch-friendly buttons */
    .btn {
        min-height: 44px;
        padding: var(--mobile-space-sm) var(--mobile-space-md);
        font-size: 0.875rem;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        border-radius: var(--border-radius);
    }
    
    .btn-sm {
        min-height: 36px;
        padding: var(--mobile-space-xs) var(--mobile-space-sm);
        font-size: 0.75rem;
    }
    
    .btn-lg {
        min-height: 56px;
        padding: var(--mobile-space-md) var(--mobile-space-lg);
        font-size: 1rem;
    }
    
    /* Button groups for mobile */
    .btn-group {
        display: flex;
        flex-direction: column;
        width: 100%;
        gap: var(--mobile-space-xs);
    }
    
    .btn-group .btn {
        border-radius: var(--border-radius) !important;
        margin-bottom: 0;
    }
    
    /* Horizontal button groups on slightly larger screens */
    @media (min-width: 480px) {
        .btn-group {
            flex-direction: row;
            gap: var(--mobile-space-xs);
        }
        
        .btn-group .btn {
            margin-bottom: 0;
            margin-right: 0;
        }
    }
    
    /* Form labels and spacing */
    label {
        margin-bottom: var(--mobile-space-xs);
        font-size: 0.875rem;
    }
    
    .form-label {
        margin-bottom: var(--mobile-space-xs);
        font-size: 0.75rem;
    }
    
    /* Form groups */
    .mb-3 {
        margin-bottom: var(--mobile-space-md) !important;
    }
    
    .form-check {
        margin-bottom: var(--mobile-space-sm);
    }
}

/* === MOBILE CARD LAYOUT === */
@media (max-width: 767px) {
    .card {
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-sm);
        margin-bottom: var(--mobile-space-md);
        border: 1px solid var(--border-color);
    }
    
    .card-header {
        padding: var(--mobile-space-md);
        border-bottom: 1px solid var(--border-color);
    }
    
    .card-body {
        padding: var(--mobile-space-md);
    }
    
    .card-footer {
        padding: var(--mobile-space-md);
        border-top: 1px solid var(--border-color);
    }
    
    /* Compact card layout for small screens */
    @media (max-width: 479px) {
        .card-header,
        .card-body,
        .card-footer {
            padding: var(--mobile-space-sm);
        }
    }
    
    /* Remove card shadows on mobile for more screen space */
    .card {
        box-shadow: none;
    }
}

/* === MOBILE TABLE HANDLING === */
@media (max-width: 767px) {
    /* Make tables horizontally scrollable */
    .table-responsive {
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border-color);
        margin-bottom: var(--mobile-space-md);
    }
    
    .table {
        font-size: 0.875rem;
        margin-bottom: 0;
        border: none;
    }
    
    .table th,
    .table td {
        padding: var(--mobile-space-sm) var(--mobile-space-xs);
        white-space: nowrap;
        vertical-align: middle;
        border-top: 1px solid var(--border-color);
    }
    
    .table thead th {
        padding: var(--mobile-space-sm) var(--mobile-space-xs);
        font-size: 0.75rem;
    }
    
    /* Compact table on very small screens */
    @media (max-width: 479px) {
        .table {
            font-size: 0.75rem;
        }
        
        .table th,
        .table td {
            padding: var(--mobile-space-xs);
        }
    }
    
    /* Hide less important columns on mobile */
    .table .d-none-mobile {
        display: none !important;
    }
    
    /* Mobile-specific table footer */
    .table tfoot {
        background: var(--bg-table-stripe);
        font-weight: 600;
    }
    
    .table tfoot th {
        border-top: 2px solid var(--border-color);
        padding: var(--mobile-space-sm) var(--mobile-space-xs);
    }
    
    /* Remove table shadows on mobile */
    .table {
        box-shadow: none;
    }
}

/* === MOBILE FILTER SECTION === */
@media (max-width: 767px) {
    .filter-form {
        background: var(--bg-card);
        border-radius: var(--border-radius);
        padding: var(--mobile-space-md);
        border: 1px solid var(--border-color);
        margin-bottom: var(--mobile-space-md);
    }
    
    .filter-form .row {
        margin: 0;
        gap: var(--mobile-space-sm);
    }
    
    .filter-form .col-xl,
    .filter-form .col-lg-4,
    .filter-form .col-md-6,
    .filter-form .col-12,
    .filter-form .col-xl-auto,
    .filter-form .col-lg-3,
    .filter-form .col-lg-2,
    .filter-form .col-lg-12 {
        padding: 0;
        margin-bottom: var(--mobile-space-sm);
    }
    
    .filter-form .col-xl:last-child,
    .filter-form .col-lg-4:last-child,
    .filter-form .col-md-6:last-child,
    .filter-form .col-12:last-child,
    .filter-form .col-xl-auto:last-child,
    .filter-form .col-lg-3:last-child,
    .filter-form .col-lg-2:last-child,
    .filter-form .col-lg-12:last-child {
        margin-bottom: 0;
    }
    
    /* Stack all form elements vertically on mobile */
    .filter-form .d-flex {
        flex-direction: column;
        align-items: stretch !important;
        gap: var(--mobile-space-sm);
    }
    
    .filter-form .d-flex > * {
        margin-bottom: 0;
        width: 100% !important;
    }
    
    /* Form control adjustments */
    .filter-form .form-control,
    .filter-form .form-select {
        padding: var(--mobile-space-sm);
    }
    
    /* Button adjustments */
    .filter-form .btn {
        padding: var(--mobile-space-sm) var(--mobile-space-md);
    }
}

/* === COLLAPSIBLE MOBILE FILTERS === */
@media (max-width: 767px) {
    .mobile-filter-toggle {
        display: block;
        width: 100%;
        margin-bottom: var(--mobile-space-md);
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: var(--border-radius);
        padding: var(--mobile-space-md);
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }
    
    .mobile-filter-toggle:after {
        content: '▼';
        float: right;
        transition: transform var(--transition-base);
    }
    
    .mobile-filter-toggle.collapsed:after {
        transform: rotate(-90deg);
    }
    
    .mobile-filter-toggle:active {
        transform: scale(0.98);
    }
    
    /* Filter collapse animation */
    .filter-collapse {
        transition: all var(--transition-base);
        overflow: hidden;
    }
    
    .filter-collapse.show {
        animation: slideDown var(--transition-base) ease-out;
    }
    
    @keyframes slideDown {
        from {
            opacity: 0;
            max-height: 0;
        }
        to {
            opacity: 1;
            max-height: 500px;
        }
    }
}

/* Hide mobile toggle on larger screens */
@media (min-width: 768px) {
    .mobile-filter-toggle {
        display: none !important;
    }
    
    .filter-collapse {
        display: block !important;
    }
}

/* === MOBILE DROPDOWN IMPROVEMENTS === */
@media (max-width: 767px) {
    .dropdown-menu {
        width: 100%;
        max-width: none;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-lg);
        margin-top: 0.25rem;
        padding: var(--mobile-space-sm);
    }
    
    .dropdown-item {
        padding: var(--mobile-space-md) var(--mobile-space-sm);
        font-size: 0.875rem;
        min-height: 44px;
        display: flex;
        align-items: center;
    }
    
    .dropdown-toggle {
        width: 100%;
        text-align: left;
        justify-content: space-between;
        padding: var(--mobile-space-sm) var(--mobile-space-md);
    }
    
    /* Columns dropdown specific styling */
    .columns-dropdown {
        max-height: 60vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        padding: var(--mobile-space-sm);
    }
    
    .columns-dropdown .form-check {
        padding: var(--mobile-space-sm);
        margin: 0;
        border-bottom: 1px solid var(--border-light);
    }
    
    .columns-dropdown .form-check:last-child {
        border-bottom: none;
    }
    
    .columns-dropdown .form-check-input {
        margin-top: 0;
        margin-right: var(--mobile-space-sm);
        width: 1.25rem;
        height: 1.25rem;
    }
    
    .columns-dropdown .form-check-label {
        font-size: 0.875rem;
        line-height: 1.5;
        margin-bottom: 0;
        cursor: pointer;
        width: 100%;
        padding: var(--mobile-space-xs) 0;
    }
}

/* === MOBILE SMALL BOXES === */
@media (max-width: 767px) {
    .small-box {
        text-align: center;
        padding: var(--mobile-space-lg) var(--mobile-space-md);
        margin-bottom: var(--mobile-space-md);
        border-radius: var(--border-radius);
    }
    
    .small-box .inner h3 {
        font-size: 1.5rem;
        margin-bottom: var(--mobile-space-sm);
    }
    
    .small-box .inner p {
        font-size: 0.875rem;
        margin-bottom: 0;
    }
    
    .small-box .icon {
        position: relative;
        float: none;
        margin-top: var(--mobile-space-sm);
    }
    
    .small-box .icon i {
        font-size: 2rem;
    }
    
    /* Compact layout for very small screens */
    @media (max-width: 479px) {
        .small-box {
            padding: var(--mobile-space-md);
        }
        
        .small-box .inner h3 {
            font-size: 1.25rem;
        }
        
        .small-box .icon i {
            font-size: 1.5rem;
        }
    }
}

/* === MOBILE NAVIGATION === */
@media (max-width: 767px) {
    .main-sidebar {
        position: fixed;
        top: 0;
        left: -250px;
        width: 250px;
        height: 100vh;
        z-index: 1050;
        transition: left var(--transition-base);
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        background: var(--bg-sidebar);
    }
    
    .sidebar-open .main-sidebar {
        left: 0;
    }
    
    /* Mobile navbar */
    .main-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1040;
        padding: 0.5rem 1rem;
        background: var(--bg-navbar);
        border-bottom: 1px solid var(--border-color);
    }
    
    .content-wrapper {
        margin-top: 60px;
        margin-left: 0;
        padding: var(--mobile-space-md);
    }
    
    /* Mobile sidebar overlay */
    .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1030;
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-base);
        -webkit-tap-highlight-color: transparent;
    }
    
    .sidebar-open .sidebar-overlay {
        opacity: 1;
        visibility: visible;
    }
    
    /* Touch-friendly nav links */
    .nav-sidebar .nav-link {
        padding: 1rem;
        font-size: 1rem;
        min-height: 56px;
        display: flex;
        align-items: center;
    }
    
    .nav-sidebar .nav-icon {
        margin-right: 1rem;
        font-size: 1.125rem;
    }
    
    /* Remove sidebar animations on mobile for performance */
    .main-sidebar {
        transition: none;
    }
}

/* === MOBILE MODAL IMPROVEMENTS === */
@media (max-width: 767px) {
    .modal-dialog {
        margin: 0;
        width: 100vw;
        height: 100vh;
        max-width: none;
        max-height: none;
    }
    
    .modal-content {
        height: 100vh;
        border-radius: 0;
        border: none;
        display: flex;
        flex-direction: column;
    }
    
    .modal-header {
        flex-shrink: 0;
        padding: var(--mobile-space-md);
        border-bottom: 1px solid var(--border-color);
    }
    
    .modal-body {
        flex: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        padding: var(--mobile-space-md);
    }
    
    .modal-footer {
        flex-shrink: 0;
        padding: var(--mobile-space-md);
        border-top: 1px solid var(--border-color);
    }
    
    /* Modal tabs for mobile */
    .modal .nav-tabs {
        border-bottom: 1px solid var(--border-color);
        margin-bottom: var(--mobile-space-md);
    }
    
    .modal .nav-tabs .nav-link {
        padding: var(--mobile-space-sm) var(--mobile-space-xs);
        font-size: 0.875rem;
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
    }
    
    .modal .nav-tabs .nav-link i {
        margin-right: var(--mobile-space-xs);
        font-size: 0.875rem;
    }
    
    /* Hide tab text on very small screens, show only icons */
    @media (max-width: 479px) {
        .modal .nav-tabs .nav-link {
            padding: var(--mobile-space-sm);
        }
        
        .modal .nav-tabs .nav-link i {
            margin-right: 0;
        }
        
        .modal .nav-tabs .nav-link:not(.active) p,
        .modal .nav-tabs .nav-link:not(.active) span:not(.sr-only) {
            display: none;
        }
    }
    
    /* Modal form adjustments */
    .modal .form-control,
    .modal .form-select {
        padding: var(--mobile-space-sm);
    }
    
    .modal .btn {
        padding: var(--mobile-space-sm) var(--mobile-space-md);
    }
}

/* === MOBILE UTILITIES === */
@media (max-width: 767px) {
    /* Mobile-specific spacing */
    .mobile-mb-3 { margin-bottom: var(--mobile-space-lg) !important; }
    .mobile-mb-2 { margin-bottom: var(--mobile-space-md) !important; }
    .mobile-mb-1 { margin-bottom: var(--mobile-space-sm) !important; }
    .mobile-mt-3 { margin-top: var(--mobile-space-lg) !important; }
    .mobile-mt-2 { margin-top: var(--mobile-space-md) !important; }
    .mobile-mt-1 { margin-top: var(--mobile-space-sm) !important; }
    .mobile-p-3 { padding: var(--mobile-space-lg) !important; }
    .mobile-p-2 { padding: var(--mobile-space-md) !important; }
    .mobile-p-1 { padding: var(--mobile-space-sm) !important; }
    
    /* Mobile text alignment */
    .mobile-text-center { text-align: center !important; }
    .mobile-text-left { text-align: left !important; }
    .mobile-text-right { text-align: right !important; }
    
    /* Mobile flex utilities */
    .mobile-flex-column { flex-direction: column !important; }
    .mobile-flex-row { flex-direction: row !important; }
    .mobile-justify-center { justify-content: center !important; }
    .mobile-align-center { align-items: center !important; }
    
    /* Mobile display utilities */
    .mobile-d-none { display: none !important; }
    .mobile-d-block { display: block !important; }
    .mobile-d-flex { display: flex !important; }
    
    /* Mobile width utilities */
    .mobile-w-100 { width: 100% !important; }
    .mobile-w-auto { width: auto !important; }
    
    /* Remove unnecessary shadows and borders on mobile */
    .mobile-no-shadow {
        box-shadow: none !important;
    }
    
    .mobile-no-border {
        border: none !important;
    }
    
    .mobile-no-radius {
        border-radius: 0 !important;
    }
}

/* === LANDSCAPE PHONE OPTIMIZATIONS (480px - 767px) === */
@media (min-width: 480px) and (max-width: 767px) {
    /* Two-column layout for forms */
    .filter-form .row {
        display: flex;
        flex-wrap: wrap;
        gap: var(--mobile-space-sm);
    }
    
    .filter-form .col-xl,
    .filter-form .col-lg-4,
    .filter-form .col-md-6 {
        flex: 0 0 calc(50% - var(--mobile-space-sm));
        max-width: calc(50% - var(--mobile-space-sm));
    }
    
    /* Horizontal button groups */
    .btn-group {
        flex-direction: row;
        gap: var(--mobile-space-xs);
    }
    
    /* Better modal layout */
    .modal-dialog {
        margin: 2rem auto;
        width: calc(100vw - 4rem);
        height: calc(100vh - 4rem);
        max-width: 500px;
    }
    
    .modal-content {
        height: 100%;
        border-radius: var(--border-radius-lg);
    }
}

/* === TABLET OPTIMIZATIONS (768px - 991px) === */
@media (min-width: 768px) and (max-width: 991px) {
    /* Three-column layout for forms */
    .filter-form .col-xl,
    .filter-form .col-lg-4 {
        flex: 0 0 calc(33.333333% - var(--space-sm));
        max-width: calc(33.333333% - var(--space-sm));
    }
    
    .filter-form .col-xl-auto,
    .filter-form .col-lg-3 {
        flex: 0 0 calc(25% - var(--space-sm));
        max-width: calc(25% - var(--space-sm));
    }
    
    /* Better table layout */
    .table th,
    .table td {
        padding: 0.75rem 0.5rem;
    }
    
    /* Improved sidebar */
    .main-sidebar {
        width: 200px;
    }
    
    .content-wrapper {
        margin-left: 200px;
    }
}

/* === TOUCH DEVICE OPTIMIZATIONS === */
@media (hover: none) and (pointer: coarse) {
    /* Remove hover effects on touch devices */
    .card:hover,
    .btn:hover,
    .small-box:hover {
        transform: none;
        box-shadow: inherit;
    }
    
    /* Enhanced touch targets */
    .clickable,
    .btn,
    .nav-link,
    .dropdown-toggle {
        min-height: 44px;
        min-width: 44px;
    }
    
    /* Improve scrolling performance */
    .table-responsive,
    .modal-body,
    .dropdown-menu {
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
    }
}

/* === ACCESSIBILITY IMPROVEMENTS FOR MOBILE === */
@media (max-width: 767px) {
    /* High contrast focus indicators */
    *:focus {
        outline: 3px solid var(--primary-color);
        outline-offset: 2px;
    }
    
    /* Screen reader improvements */
    .sr-only-mobile {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }
    
    /* Skip navigation link for mobile */
    .skip-nav {
        position: absolute;
        top: -50px;
        left: 0;
        width: 100%;
        background: var(--primary-color);
        color: white;
        text-align: center;
        padding: 1rem;
        z-index: 10000;
        transition: top var(--transition-base);
    }
    
    .skip-nav:focus {
        top: 0;
    }
}

/* === MOBILE SCROLL HINTS === */
.mobile-scroll-hint {
    position: absolute;
    bottom: 0.5rem;
    right: 0.5rem;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    opacity: 0.8;
    z-index: 10;
    animation: fadeInOut 3s ease-in-out infinite;
}

@keyframes fadeInOut {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.8; }
}

/* === TOUCH FEEDBACK === */
.touch-active {
    transform: scale(0.95) !important;
    opacity: 0.8 !important;
    transition: all 0.1s ease !important;
}

/* === MOBILE FILTER TOGGLE FIXES === */
.mobile-filter-toggle {
    width: 100%;
    text-align: left;
    border: none;
    background: transparent;
    color: inherit;
    font-size: 1rem;
    padding: 0.75rem 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.mobile-filter-toggle:hover {
    background: var(--bg-table-hover);
}

/* === MOBILE BUTTON GROUP IMPROVEMENTS === */
.mobile-btn-group {
    gap: 0.25rem;
}

.mobile-btn-group .btn {
    flex: 1;
    min-width: 0;
}

/* === MOBILE FORM IMPROVEMENTS === */
.form-mobile {
    font-size: 1rem; /* Prevent zoom on iOS */
    border-radius: 0.5rem;
    transition: all 0.2s ease;
}

.form-mobile:focus {
    transform: scale(1.02);
    box-shadow: 0 0 0 0.25rem rgba(var(--primary-color-rgb), 0.25);
}

/* === TABLE MOBILE OPTIMIZATIONS === */
.table-mobile {
    font-size: 0.875rem;
}

.table-mobile th,
.table-mobile td {
    min-width: 80px;
    white-space: nowrap;
    padding: var(--mobile-space-sm) var(--mobile-space-xs);
}

.table-mobile .badge {
    font-size: 0.7rem;
    padding: 0.25em 0.5em;
}

/* === MODAL MOBILE OPTIMIZATIONS === */
.modal-fullscreen-mobile {
    width: 100vw;
    height: 100vh;
    margin: 0;
    max-width: none;
    max-height: none;
}

.modal-fullscreen-mobile .modal-content {
    height: 100vh;
    border-radius: 0;
    border: none;
}

/* === CSS CUSTOM PROPERTIES FOR PRIMARY COLOR RGB === */
:root {
    --primary-color-rgb: 0, 102, 204;
}

.dark-mode {
    --primary-color-rgb: 88, 166, 255;
}

/* === FIXED PAGINATION AND TABLE LAYOUT === */
/* Ensure pagination stays outside scrollable area */
.table-container {
    max-height: 70vh;
    overflow-x: auto;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    position: relative;
}

/* Ensure table-responsive within table-container scrolls properly */
.table-container .table-responsive {
    max-height: none;
    height: 100%;
    overflow: visible;
}

/* Static pagination outside scrollable area */
.datatable-footer {
    position: relative;
    background: var(--bg-card) !important;
    border-top: 1px solid var(--border-color) !important;
    z-index: 10;
    padding: var(--mobile-space-sm);
}

/* DataTables layout improvements */
.datatable-header,
.datatable-footer {
    background: var(--bg-card);
    padding: 0.75rem;
    border-bottom: 1px solid var(--border-color);
}

.datatable-footer {
    border-bottom: none;
    border-top: 1px solid var(--border-color);
}

.datatable-length,
.datatable-search,
.datatable-info,
.datatable-pagination {
    margin: 0;
}

.datatable-pagination {
    flex-wrap: wrap;
}

/* Mobile pagination improvements */
@media (max-width: 767px) {
    .datatable-header,
    .datatable-footer {
        padding: var(--mobile-space-sm);
    }
    
    .datatable-header {
        flex-direction: column;
        gap: var(--mobile-space-sm);
    }
    
    .datatable-footer {
        flex-direction: column-reverse;
        gap: var(--mobile-space-sm);
        text-align: center;
    }
    
    .datatable-length select,
    .datatable-search input {
        width: 100%;
        max-width: 100%;
        padding: var(--mobile-space-sm);
    }
    
    .datatable-pagination {
        justify-content: center;
    }
    
    .datatable-pagination .paginate_button {
        margin: var(--mobile-space-xs);
        padding: var(--mobile-space-xs) var(--mobile-space-sm);
        min-width: 32px;
        font-size: 0.75rem;
    }
    
    /* Compact pagination for very small screens */
    @media (max-width: 479px) {
        .datatable-pagination .paginate_button {
            padding: var(--mobile-space-xs);
            min-width: 28px;
            font-size: 0.7rem;
        }
    }
}

/* Table responsive improvements */
.table-responsive {
    border-radius: var(--border-radius);
}

.table-responsive .table {
    margin-bottom: 0;
}

/* Ensure all columns are visible and manageable */
.table th,
.table td {
    white-space: nowrap;
    min-width: 80px;
}

.table th:first-child,
.table td:first-child {
    min-width: 100px; /* Date column */
}

.table th:last-child,
.table td:last-child,
.table th:nth-last-child(2),
.table td:nth-last-child(2) {
    min-width: 90px; /* Sum columns */
}

/* Column visibility controls */
.columns-dropdown {
    min-width: 200px;
}

/* Responsive improvements */
@media (max-width: 768px) {
    /* Card hover transform removed */
    
    .btn {
        padding: 0.625rem 1.25rem;
        font-size: 0.875rem;
    }
    
    .small-box:hover {
        transform: translateY(-4px) scale(1.02);
    }
    
    .table tbody tr:hover {
        transform: none;
    }
}

/* Animation utilities */
.fade-in {
    animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.slide-in {
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
}

/* ================= DROPDOWN THEME STYLING (Bootstrap Default + Theme Colors) ================= */

/* Basic dropdown styling - keep Bootstrap defaults */
.dropdown-menu {
    background-color: var(--dropdown-bg) !important;
    border: 1px solid var(--dropdown-border) !important;
    box-shadow: var(--dropdown-shadow) !important;
    color: var(--text-primary) !important;
}

.dropdown-item {
    color: var(--text-primary) !important;
    background-color: transparent !important;
}

.dropdown-item:hover,
.dropdown-item:focus {
    background-color: var(--bg-table-hover) !important;
    color: var(--text-primary) !important;
}

.dropdown-divider {
    border-top: 1px solid var(--border-color) !important;
}

/* Columns dropdown - minimal styling with theme colors only */
.columns-dropdown {
    background-color: var(--dropdown-bg) !important;
    border: 1px solid var(--dropdown-border) !important;
    box-shadow: var(--dropdown-shadow) !important;
    color: var(--text-primary) !important;
    /* Let Bootstrap handle all positioning and layout */
}

.dark-mode .columns-dropdown {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.8) !important;
}

/* Form check styling for theme colors only */
.columns-dropdown .form-check {
    /* Keep Bootstrap default layout, only style colors */
    background-color: transparent;
}

.columns-dropdown .form-check:hover {
    background-color: var(--bg-table-hover) !important;
}

.columns-dropdown .form-check-label {
    color: var(--text-primary) !important;
}

.columns-dropdown .form-check-input {
    background-color: var(--input-bg) !important;
    border-color: var(--input-border) !important;
}

.columns-dropdown .form-check-input:checked {
    background-color: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
}

.columns-dropdown .form-check-input:focus {
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}

/* Z-index management - minimal intervention */
.dropdown-menu {
    z-index: 1000; /* Bootstrap default */
}

.columns-dropdown {
    z-index: 1001; /* Slightly higher for visibility */
}